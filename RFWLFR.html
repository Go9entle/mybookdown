<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Random forest weighted local Frechet regression with random objects | GOGENTLE’s NOTEBOOK</title>
  <meta name="description" content="这是用R的bookdown功能制作的课堂笔记。" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Random forest weighted local Frechet regression with random objects | GOGENTLE’s NOTEBOOK" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="这是用R的bookdown功能制作的课堂笔记。" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Random forest weighted local Frechet regression with random objects | GOGENTLE’s NOTEBOOK" />
  
  <meta name="twitter:description" content="这是用R的bookdown功能制作的课堂笔记。" />
  

<meta name="author" content="gogentle" />


<meta name="date" content="2025-03-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html"/>
<link rel="next" href="qrm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/SVG"],
  extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
</script>
<script type="text/javascript"
   src="../../../MathJax/MathJax.js">
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GZT FOR REAL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>写在前面</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#为什么要写课程笔记"><i class="fa fa-check"></i>为什么要写课程笔记</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="关于涛哥.html"><a href="关于涛哥.html"><i class="fa fa-check"></i>关于涛哥</a></li>
<li class="part"><span><b>I 课程笔记</b></span></li>
<li class="chapter" data-level="1" data-path="rlforfin.html"><a href="rlforfin.html"><i class="fa fa-check"></i><b>1</b> 强化学习在金融中的应用</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rlforfin.html"><a href="rlforfin.html#Markov"><i class="fa fa-check"></i><b>1.1</b> Markov过程</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="rlforfin.html"><a href="rlforfin.html#过程中的状态概念"><i class="fa fa-check"></i><b>1.1.1</b> 过程中的状态概念</a></li>
<li class="chapter" data-level="1.1.2" data-path="rlforfin.html"><a href="rlforfin.html#通过股票价格的例子理解markov性"><i class="fa fa-check"></i><b>1.1.2</b> 通过股票价格的例子理解Markov性</a></li>
<li class="chapter" data-level="1.1.3" data-path="rlforfin.html"><a href="rlforfin.html#markov过程的正式定义"><i class="fa fa-check"></i><b>1.1.3</b> Markov过程的正式定义</a></li>
<li class="chapter" data-level="1.1.4" data-path="rlforfin.html"><a href="rlforfin.html#markov过程的稳态分布"><i class="fa fa-check"></i><b>1.1.4</b> Markov过程的稳态分布</a></li>
<li class="chapter" data-level="1.1.5" data-path="rlforfin.html"><a href="rlforfin.html#markov奖励过程的形式主义"><i class="fa fa-check"></i><b>1.1.5</b> Markov奖励过程的形式主义</a></li>
<li class="chapter" data-level="1.1.6" data-path="rlforfin.html"><a href="rlforfin.html#markov奖励过程的价值函数"><i class="fa fa-check"></i><b>1.1.6</b> Markov奖励过程的价值函数</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="rlforfin.html"><a href="rlforfin.html#MDP"><i class="fa fa-check"></i><b>1.2</b> Markov决策过程</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="rlforfin.html"><a href="rlforfin.html#不确定性下的序列决策难题"><i class="fa fa-check"></i><b>1.2.1</b> 不确定性下的序列决策难题</a></li>
<li class="chapter" data-level="1.2.2" data-path="rlforfin.html"><a href="rlforfin.html#markov决策过程的正式定义"><i class="fa fa-check"></i><b>1.2.2</b> Markov决策过程的正式定义</a></li>
<li class="chapter" data-level="1.2.3" data-path="rlforfin.html"><a href="rlforfin.html#策略"><i class="fa fa-check"></i><b>1.2.3</b> 策略</a></li>
<li class="chapter" data-level="1.2.4" data-path="rlforfin.html"><a href="rlforfin.html#markov决策过程策略-markov奖励过程"><i class="fa fa-check"></i><b>1.2.4</b> [Markov决策过程，策略]:= Markov奖励过程</a></li>
<li class="chapter" data-level="1.2.5" data-path="rlforfin.html"><a href="rlforfin.html#固定策略下的mdp价值函数"><i class="fa fa-check"></i><b>1.2.5</b> 固定策略下的MDP价值函数</a></li>
<li class="chapter" data-level="1.2.6" data-path="rlforfin.html"><a href="rlforfin.html#最优价值函数和最优策略"><i class="fa fa-check"></i><b>1.2.6</b> 最优价值函数和最优策略</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rlforfin.html"><a href="rlforfin.html#dynamicprogram"><i class="fa fa-check"></i><b>1.3</b> 动态规划算法</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rlforfin.html"><a href="rlforfin.html#planning-vs-learning"><i class="fa fa-check"></i><b>1.3.1</b> Planning vs Learning</a></li>
<li class="chapter" data-level="1.3.2" data-path="rlforfin.html"><a href="rlforfin.html#不动点理论"><i class="fa fa-check"></i><b>1.3.2</b> 不动点理论</a></li>
<li class="chapter" data-level="1.3.3" data-path="rlforfin.html"><a href="rlforfin.html#贝尔曼策略算子以及策略评估算法"><i class="fa fa-check"></i><b>1.3.3</b> 贝尔曼策略算子以及策略评估算法</a></li>
<li class="chapter" data-level="1.3.4" data-path="rlforfin.html"><a href="rlforfin.html#贪心策略"><i class="fa fa-check"></i><b>1.3.4</b> 贪心策略</a></li>
<li class="chapter" data-level="1.3.5" data-path="rlforfin.html"><a href="rlforfin.html#策略提升"><i class="fa fa-check"></i><b>1.3.5</b> 策略提升</a></li>
<li class="chapter" data-level="1.3.6" data-path="rlforfin.html"><a href="rlforfin.html#策略迭代算法"><i class="fa fa-check"></i><b>1.3.6</b> 策略迭代算法</a></li>
<li class="chapter" data-level="1.3.7" data-path="rlforfin.html"><a href="rlforfin.html#贝尔曼最优性算子与值迭代算法"><i class="fa fa-check"></i><b>1.3.7</b> 贝尔曼最优性算子与值迭代算法</a></li>
<li class="chapter" data-level="1.3.8" data-path="rlforfin.html"><a href="rlforfin.html#从最优值函数到最优策略"><i class="fa fa-check"></i><b>1.3.8</b> 从最优值函数到最优策略</a></li>
<li class="chapter" data-level="1.3.9" data-path="rlforfin.html"><a href="rlforfin.html#广义策略迭代"><i class="fa fa-check"></i><b>1.3.9</b> 广义策略迭代</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="rlforfin.html"><a href="rlforfin.html#dynassall"><i class="fa fa-check"></i><b>1.4</b> 动态资产配置和消费</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="rlforfin.html"><a href="rlforfin.html#个人财务的优化"><i class="fa fa-check"></i><b>1.4.1</b> 个人财务的优化</a></li>
<li class="chapter" data-level="1.4.2" data-path="rlforfin.html"><a href="rlforfin.html#merton投资组合问题及其解决"><i class="fa fa-check"></i><b>1.4.2</b> Merton投资组合问题及其解决</a></li>
<li class="chapter" data-level="1.4.3" data-path="rlforfin.html"><a href="rlforfin.html#merton投资组合问题解的直觉"><i class="fa fa-check"></i><b>1.4.3</b> Merton投资组合问题解的直觉</a></li>
<li class="chapter" data-level="1.4.4" data-path="rlforfin.html"><a href="rlforfin.html#离散时间资产配置"><i class="fa fa-check"></i><b>1.4.4</b> 离散时间资产配置</a></li>
<li class="chapter" data-level="1.4.5" data-path="rlforfin.html"><a href="rlforfin.html#现实世界的应用"><i class="fa fa-check"></i><b>1.4.5</b> 现实世界的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>2</b> 广义线性模型</a>
<ul>
<li class="chapter" data-level="2.1" data-path="glm.html"><a href="glm.html#glmexp"><i class="fa fa-check"></i><b>2.1</b> 广义线性模型的指数族分布</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="RFWLFR.html"><a href="RFWLFR.html"><i class="fa fa-check"></i><b>3</b> Random forest weighted local Frechet regression with random objects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="RFWLFR.html"><a href="RFWLFR.html#rfwlfr2"><i class="fa fa-check"></i><b>3.1</b> 提出的方法</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="RFWLFR.html"><a href="RFWLFR.html#rfwlfr21"><i class="fa fa-check"></i><b>3.1.1</b> 预备知识</a></li>
<li class="chapter" data-level="3.1.2" data-path="RFWLFR.html"><a href="RFWLFR.html#rfwlfr22"><i class="fa fa-check"></i><b>3.1.2</b> Local constant method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="qrm.html"><a href="qrm.html"><i class="fa fa-check"></i><b>4</b> 量化风险管理</a>
<ul>
<li class="chapter" data-level="4.1" data-path="qrm.html"><a href="qrm.html#rmconcept"><i class="fa fa-check"></i><b>4.1</b> 风险管理的基本概念</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="qrm.html"><a href="qrm.html#建模价值和价值变动"><i class="fa fa-check"></i><b>4.1.1</b> 建模价值和价值变动</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stochastic.html"><a href="stochastic.html"><i class="fa fa-check"></i><b>5</b> 随机分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stochastic.html"><a href="stochastic.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stochastic.html"><a href="stochastic.html#最优停时optimal-stopping"><i class="fa fa-check"></i><b>5.1.1</b> 1.4 最优停时（Optimal Stopping）</a></li>
<li class="chapter" data-level="5.1.2" data-path="stochastic.html"><a href="stochastic.html#随机控制stochastic-control"><i class="fa fa-check"></i><b>5.1.2</b> 1.5 随机控制（Stochastic Control）</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stochastic.html"><a href="stochastic.html#预备知识"><i class="fa fa-check"></i><b>5.2</b> 预备知识</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="stochastic.html"><a href="stochastic.html#概率空间-随机变量-随机过程"><i class="fa fa-check"></i><b>5.2.1</b> 概率空间 随机变量 随机过程</a></li>
<li class="chapter" data-level="5.2.2" data-path="stochastic.html"><a href="stochastic.html#布朗运动brownian-motion"><i class="fa fa-check"></i><b>5.2.2</b> 布朗运动（Brownian Motion）</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 语言基础</b></span></li>
<li class="chapter" data-level="6" data-path="english.html"><a href="english.html"><i class="fa fa-check"></i><b>6</b> 英语</a>
<ul>
<li class="chapter" data-level="6.1" data-path="english.html"><a href="english.html#week2"><i class="fa fa-check"></i><b>6.1</b> week2</a></li>
<li class="chapter" data-level="6.2" data-path="english.html"><a href="english.html#week3"><i class="fa fa-check"></i><b>6.2</b> week3</a></li>
</ul></li>
<li class="part"><span><b>III 讨论班报告</b></span></li>
<li class="chapter" data-level="7" data-path="cdc.html"><a href="cdc.html"><i class="fa fa-check"></i><b>7</b> Optimal strategies for collective defined contribution plans when the stock and labor markets are co-integrated（股票和劳动力市场协同整合时集体确定缴款计划的最优策略）</a>
<ul>
<li class="chapter" data-level="7.1" data-path="cdc.html"><a href="cdc.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="cdc.html"><a href="cdc.html#相关工作"><i class="fa fa-check"></i><b>7.1.1</b> 相关工作</a></li>
<li class="chapter" data-level="7.1.2" data-path="cdc.html"><a href="cdc.html#主要区别"><i class="fa fa-check"></i><b>7.1.2</b> 主要区别</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="cdc.html"><a href="cdc.html#模型的公式化"><i class="fa fa-check"></i><b>7.2</b> 模型的公式化</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="cdc.html"><a href="cdc.html#金融市场"><i class="fa fa-check"></i><b>7.2.1</b> 金融市场</a></li>
<li class="chapter" data-level="7.2.2" data-path="cdc.html"><a href="cdc.html#劳动收入"><i class="fa fa-check"></i><b>7.2.2</b> 劳动收入</a></li>
<li class="chapter" data-level="7.2.3" data-path="cdc.html"><a href="cdc.html#养老金系统"><i class="fa fa-check"></i><b>7.2.3</b> 养老金系统</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="cdc.html"><a href="cdc.html#养老金基金计划的最优策略"><i class="fa fa-check"></i><b>7.3</b> 养老金基金计划的最优策略</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="cdc.html"><a href="cdc.html#具有特质性冲击的最优策略"><i class="fa fa-check"></i><b>7.3.1</b> 具有特质性冲击的最优策略</a></li>
<li class="chapter" data-level="7.3.2" data-path="cdc.html"><a href="cdc.html#无特质性冲击时的最优策略"><i class="fa fa-check"></i><b>7.3.2</b> 无特质性冲击时的最优策略</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="cdc.html"><a href="cdc.html#数值分析"><i class="fa fa-check"></i><b>7.4</b> 数值分析</a></li>
<li class="chapter" data-level="7.5" data-path="cdc.html"><a href="cdc.html#总结"><i class="fa fa-check"></i><b>7.5</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mulreinsurance.html"><a href="mulreinsurance.html"><i class="fa fa-check"></i><b>8</b> 最优多维再保险与多元风险厌恶效用</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mulreinsurance.html"><a href="mulreinsurance.html#OMR"><i class="fa fa-check"></i><b>8.1</b> 共同冲击依赖结构下的最优多维再保险政策</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mulreinsurance.html"><a href="mulreinsurance.html#common-shock-model"><i class="fa fa-check"></i><b>8.1.1</b> Common shock model</a></li>
<li class="chapter" data-level="8.1.2" data-path="mulreinsurance.html"><a href="mulreinsurance.html#hjb-equation"><i class="fa fa-check"></i><b>8.1.2</b> HJB equation</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mulreinsurance.html"><a href="mulreinsurance.html#mrau"><i class="fa fa-check"></i><b>8.2</b> 应用于ESG投资的多元风险厌恶效用</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mulreinsurance.html"><a href="mulreinsurance.html#setting-and-theoretical-results"><i class="fa fa-check"></i><b>8.2.1</b> Setting and theoretical results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="RLreinsurance.html"><a href="RLreinsurance.html"><i class="fa fa-check"></i><b>9</b> A Hybrid Framework for Reinsurance Optimization: Integrating Generative Models and Reinforcement Learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="RLreinsurance.html"><a href="RLreinsurance.html#rlreabstract"><i class="fa fa-check"></i><b>9.1</b> Abstract</a></li>
<li class="chapter" data-level="9.2" data-path="RLreinsurance.html"><a href="RLreinsurance.html#rlreintro"><i class="fa fa-check"></i><b>9.2</b> Introduction</a></li>
<li class="chapter" data-level="9.3" data-path="RLreinsurance.html"><a href="RLreinsurance.html#rlremodel"><i class="fa fa-check"></i><b>9.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="RLreinsurance.html"><a href="RLreinsurance.html#离散时间框架"><i class="fa fa-check"></i><b>9.3.1</b> 离散时间框架</a></li>
<li class="chapter" data-level="9.3.2" data-path="RLreinsurance.html"><a href="RLreinsurance.html#盈余过程建模"><i class="fa fa-check"></i><b>9.3.2</b> 盈余过程建模</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 课外学习笔记</b></span></li>
<li class="chapter" data-level="10" data-path="datawhale.html"><a href="datawhale.html"><i class="fa fa-check"></i><b>10</b> Datawhale Quant</a>
<ul>
<li class="chapter" data-level="10.1" data-path="datawhale.html"><a href="datawhale.html#investquant"><i class="fa fa-check"></i><b>10.1</b> 投资与量化投资</a></li>
<li class="chapter" data-level="10.2" data-path="datawhale.html"><a href="datawhale.html#finmarket"><i class="fa fa-check"></i><b>10.2</b> 金融市场的基本概念</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="datawhale.html"><a href="datawhale.html#monetaryfin"><i class="fa fa-check"></i><b>10.2.1</b> 货币金融学</a></li>
<li class="chapter" data-level="10.2.2" data-path="datawhale.html"><a href="datawhale.html#investfin"><i class="fa fa-check"></i><b>10.2.2</b> 投资学</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="datawhale.html"><a href="datawhale.html#stockdataget"><i class="fa fa-check"></i><b>10.3</b> 股票数据获取</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="datawhale.html"><a href="datawhale.html#股票数据常见指标介绍"><i class="fa fa-check"></i><b>10.3.1</b> 股票数据常见指标介绍</a></li>
<li class="chapter" data-level="10.3.2" data-path="datawhale.html"><a href="datawhale.html#baostock的基础数据获取"><i class="fa fa-check"></i><b>10.3.2</b> Baostock的基础数据获取</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="datawhale.html"><a href="datawhale.html#quantselect"><i class="fa fa-check"></i><b>10.4</b> 量化选股策略</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="datawhale.html"><a href="datawhale.html#fctsctm"><i class="fa fa-check"></i><b>10.4.1</b> 因子选股模型</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="causal.html"><a href="causal.html"><i class="fa fa-check"></i><b>11</b> 格兰格因果性</a>
<ul>
<li class="chapter" data-level="11.1" data-path="causal.html"><a href="causal.html#causal-intro"><i class="fa fa-check"></i><b>11.1</b> 介绍</a></li>
<li class="chapter" data-level="11.2" data-path="causal.html"><a href="causal.html#causal-def"><i class="fa fa-check"></i><b>11.2</b> 格兰格因果性的定义</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="usage.html"><a href="usage.html"><i class="fa fa-check"></i><b>12</b> 中文图书Bookdown模板的基本用法</a>
<ul>
<li class="chapter" data-level="12.1" data-path="usage.html"><a href="usage.html#usage-ins"><i class="fa fa-check"></i><b>12.1</b> 安装设置</a></li>
<li class="chapter" data-level="12.2" data-path="usage.html"><a href="usage.html#usage-writing"><i class="fa fa-check"></i><b>12.2</b> 编写自己的内容</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="usage.html"><a href="usage.html#usage-writing-struct"><i class="fa fa-check"></i><b>12.2.1</b> 文档结构</a></li>
<li class="chapter" data-level="12.2.2" data-path="usage.html"><a href="usage.html#usage-writing-fig"><i class="fa fa-check"></i><b>12.2.2</b> 图形自动编号</a></li>
<li class="chapter" data-level="12.2.3" data-path="usage.html"><a href="usage.html#usage-writing-tab"><i class="fa fa-check"></i><b>12.2.3</b> 表格自动编号</a></li>
<li class="chapter" data-level="12.2.4" data-path="usage.html"><a href="usage.html#usage-writing-math"><i class="fa fa-check"></i><b>12.2.4</b> 数学公式编号</a></li>
<li class="chapter" data-level="12.2.5" data-path="usage.html"><a href="usage.html#文献引用与文献列表"><i class="fa fa-check"></i><b>12.2.5</b> 文献引用与文献列表</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="usage.html"><a href="usage.html#usage-output"><i class="fa fa-check"></i><b>12.3</b> 转换</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="usage.html"><a href="usage.html#usage-gitbook"><i class="fa fa-check"></i><b>12.3.1</b> 转换为网页</a></li>
<li class="chapter" data-level="12.3.2" data-path="usage.html"><a href="usage.html#usage-pdfbook"><i class="fa fa-check"></i><b>12.3.2</b> 生成PDF</a></li>
<li class="chapter" data-level="12.3.3" data-path="usage.html"><a href="usage.html#usage-website"><i class="fa fa-check"></i><b>12.3.3</b> 上传到网站</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://go9entle.github.io" target="_blank">Proudly Presented by GZT</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GOGENTLE’s NOTEBOOK</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="RFWLFR" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Random forest weighted local Frechet regression with random objects<a href="RFWLFR.html#RFWLFR" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>《带有随机对象的随机森林加权局部 Frechet 回归》</strong>这篇文章是中国人民大学统计学院2025年春季研究生课程广义线性模型的小组汇报论文。小组成员除了我还包括Huang Jinming &amp; Yang Zhe.这是<a href="https://www.jmlr.org/papers/volume25/23-0811/23-0811.pdf">论文原文</a>。</p>
<div id="rfwlfr2" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 提出的方法<a href="RFWLFR.html#rfwlfr2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在@ref(Local constant method)节正式展示方法之前，需要进行一些初步的准备工作，包括提供Frechet回归的背景介绍，并解释Frechet树的构建过程，这是我们方法的基本组成部分。</p>
<div id="rfwlfr21" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 预备知识<a href="RFWLFR.html#rfwlfr21" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(<code>#rfwlfr21</code>带数字是否可以？？)</p>
<div id="frechet回归" class="section level4 hasAnchor" number="3.1.1.1">
<h4><span class="header-section-number">3.1.1.1</span> Frechet回归<a href="RFWLFR.html#frechet回归" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>设<span class="math inline">\((\Omega,d)\)</span>为一个配备特定度量<span class="math inline">\(d\)</span>的度量空间，<span class="math inline">\(\mathcal{R}^p\)</span>是一个<span class="math inline">\(p\)</span>维的欧氏空间。我们考虑一个随机对<span class="math inline">\((X,Y)\sim F,\)</span>其中<span class="math inline">\(X\sim\mathcal{R}^p,Y\sim \Omega\)</span>并且<span class="math inline">\(F\)</span>是<span class="math inline">\((X,Y)\)</span>的联合分布。记<span class="math inline">\(X,Y\)</span>的边际分布分别为<span class="math inline">\(F_X,F_Y\)</span>,条件分布<span class="math inline">\(F_{X|Y},F_{Y|X}\)</span>也假设存在。当<span class="math inline">\(\Omega\subseteq \mathcal{R}\)</span>时，经典回归的目标是估计条件均值</p>
<p><span class="math display">\[
m(x)=E(Y\mid X=x)=\mathop{\arg\min}_{y\in\mathcal{R}} E\left\{(Y-y)^2\mid X=x\right\}.
\]</span>
通过将欧几里得距离替换成<span class="math inline">\(\Omega\)</span>的内在度量<span class="math inline">\(d,\)</span>条件Fr'echet均值可以定义为</p>
<p><span class="math display">\[
m_{\oplus}(x)=\mathop{\arg\min}_{y \in \Omega} M_{\oplus}(x,y)=\mathop{\arg\min}_{y \in \Omega} E\big\{d^{2}(Y, y) \mid X=x\big\}.
\]</span>
给定一个独立同分布的训练样本<span class="math inline">\(\mathcal{D}_n=\{(X_i,Y_i)\}_{i=1}^n\)</span>其中<span class="math inline">\((X_i,Y_i)\sim F\)</span>,Fr'echet回归的目标是在样本层面估计<span class="math inline">\(m_{\oplus}(x)\)</span>,为此Hein (2009) 将Nadaraya-Watson回归推广到Frechet版本：</p>
<p><span class="math display">\[
\hat{m}_{\oplus}^{\text{NW}}(x)=\mathop{\arg\min}_{y \in \Omega} \frac{1}{n} \sum_{i=1}^{n} K_{h}\left(X_{i}-x\right) d^{2}\left(Y_{i}, y\right),
\]</span></p>
<p>其中<span class="math inline">\(K\)</span>是一个平滑核（如Epanechnikov核或高斯核），<span class="math inline">\(h\)</span>为带宽，<span class="math inline">\(K_h(\cdot)=h^{-1}K(\cdot/h)\)</span>.Petersen和Müller（2019）将标准的多元线性回归和局部线性回归重新表述为加权Fréchet均值的函数，并提出了全局Fréchet回归和局部Fréchet回归：</p>
<p><span class="math display">\[
\hat{m}_{\oplus}(x)=\mathop{\arg\min}_{y \in \Omega}  \frac{1}{n}\sum_{i=1}^{n} s_{i n}(x) d^{2}\left(Y_{i}, y\right),
\]</span>
其中<span class="math inline">\(s_{in}(x)\)</span>在全局和局部Fr'echet回归中具有不同的表示形式。<br />
Nadaraya-Watson Fr'echet回归和局部Fréchet回归都涉及核加权函数<span class="math inline">\(K\)</span>，这在<span class="math inline">\(p ≥ 3\)</span>时限制了它们的应用。为了解决这个问题，我们的目标是借助随机森林的力量，生成一个更强大的加权函数，以应对适度较大的<span class="math inline">\(p\)</span>.<br />
图<a href="RFWLFR.html#fig:manhattan">3.1</a>展示了纽约曼哈顿黄色出租车交通流统计和预测结果。这个问题可以表述为一个Fréchet回归问题，其中响应变量是一个网络（矩阵），并且考虑了14个预测变量。特别地，当<span class="math inline">\(p = 14\)</span>时，Nadaraya-Watson Fréchet回归和局部Fréchet回归方法显示出显著的局限性。在这里，我们使用Fréchet充分维数约简（Ying和Yu，2022）来实现局部Fréchet回归。尽管全局Fréchet回归不受维度限制，但它依赖于线性假设才能达到令人满意的效果。相反，从图<a href="RFWLFR.html#fig:manhattan">3.1</a>可以明显看出，我们将在本文中提出的两种方法的预测准确性高于全局Fréchet回归。</p>
<div class="figure"><span style="display:block;" id="fig:manhattan"></span>
<img src="https://Go9entle.github.io/picx-images-hosting/1740492700639.102axqi287.webp" alt="The first plot illustrates the flow statistics of yellow taxis in ten distinct zones of Manhattan, New York, during a certain time period. The thickness of the edges connecting vertices corresponds to the level of inter-zone traffic, while the size of vertices represents the total traffic volume within each zone. The remaining five plots from left to right are the predictions given by the global Fr'echet regression, local Fr'echet regression after dimension reduction, single index Fr'echet regression, RFWLCFR and RFWLLFR."  />
<p class="caption">
图3.1: The first plot illustrates the flow statistics of yellow taxis in ten distinct zones of Manhattan, New York, during a certain time period. The thickness of the edges connecting vertices corresponds to the level of inter-zone traffic, while the size of vertices represents the total traffic volume within each zone. The remaining five plots from left to right are the predictions given by the global Fr’echet regression, local Fr’echet regression after dimension reduction, single index Fr’echet regression, RFWLCFR and RFWLLFR.
</p>
</div>
</div>
<div id="frechet树" class="section level4 hasAnchor" number="3.1.1.2">
<h4><span class="header-section-number">3.1.1.2</span> Frechet树<a href="RFWLFR.html#frechet树" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>回归树<span class="math inline">\(T\)</span>从根节点（整个输入空间）递归地划分输入空间。在每次划分时，父节点根据某个特征方向和某个切割点被分成两个子节点，这些切割点由特定的划分标准决定。经过多次划分后，子节点变得足够小，形成叶节点，叶节点中的样本数据用于估计条件（Fréchet）均值。</p>
<p>在本文中，我们使用Fréchet树来指代处理度量空间值响应的回归树，不管其划分标准是什么。这里我们引入了一种自适应标准——方差减少划分标准，它利用预测变量<span class="math inline">\(X=(X^{(1)},...,X^{(p)})\)</span>和响应变量<span class="math inline">\(Y\)</span>的信息来决定节点的划分。<span class="math inline">\(Y\)</span>来自一般度量空间的杂质(impurity)不再由欧几里得距离下的方差来度量而是使用Fr'echet方差。一个内部节点<span class="math inline">\(A\)</span>的分裂可以用一对<span class="math inline">\((j,c),j\in\{1,...,p\}\)</span>来表示，表示在特征<span class="math inline">\(X^{(j)}\)</span>方向上，节点<span class="math inline">\(A\)</span>在位置<span class="math inline">\(c\)</span>被分裂，我们选取最优的<span class="math inline">\((j_n^*,c_n^*)\)</span>使得样本Frechet方差尽可能减小，以至于在同一子节点的样本具有高度的相似性。具体地，分裂准则如下</p>
<p><span class="math display">\[
\mathcal{L}_n(j,c)=\frac{1}{N_n(A)}\left\{\sum_{i:X_i\in A}d^2(Y_i,\bar{Y}_A) -\sum_{i:X_i\in A_{j,l}}d^2(Y_i,\bar{Y}_{A_{j,l}})-\sum_{i:X\in A_{j,r}}d^2(Y_i,\bar{Y}_{A_{j,r}}) \right\},
\]</span>
其中<span class="math inline">\(A_{j,l}=\{ x\in A:x^{(j)}&lt;c \},A_{j,r}=\{ x\in A:x^{(j)}\geq c \},N_n(A)\)</span>是落在节点<span class="math inline">\(A\)</span>中的样本数量，并且<span class="math inline">\(\bar{Y}_A=\mathop{\arg\min}_{y\in\Omega} \sum_{i:X_i\in A}d^2(Y_i,y)\)</span>也就是节点<span class="math inline">\(A\)</span>中样本<span class="math inline">\(Y_i\)</span>的Frechet均值，<span class="math inline">\(\bar{Y}_{A_{j,l}},\bar{Y}_{A_{j,r}}\)</span>也是类似定义的。于是最优分裂对由下面的式子决定</p>
<p><span class="math display">\[
(j_n^*,c_n^*)=\mathop{\arg\max}_{j,c} \mathcal{L}_n(j,c).
\]</span></p>
</div>
</div>
<div id="rfwlfr22" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Local constant method<a href="RFWLFR.html#rfwlfr22" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>单棵树模型可能会因为调参的不同而面临较大的偏差或方差。为了提高预测精度，我们可以聚合多棵树来构建随机森林。随机森林的预测误差与不同树之间的相关性密切相关。除了通过重采样训练数据集来生长个别树之外，通常还会引入额外的随机性，以进一步降低树之间的相关性，从而提高随机森林的性能。例如，每次分裂前会随机选择一个特征子集，分裂方向仅基于该子集来设计。在这里，我们用<span class="math inline">\(\xi\sim\Xi\)</span>表示这种辅助随机性。</p>
<p>我们首先考虑经典的欧几里得响应的随机森林。每棵树是在训练数据集<span class="math inline">\(\mathcal{D}_n\)</span>的一个子样本<span class="math inline">\(\mathcal{D}_n^b=\{(X_{i_{b,1}},Y_{i_{b,1}}),(X_{i_{b,2}},Y_{i_{b,2}}),...,(X_{i_{b,s_n}},Y_{i_{b,s_n}})\}\)</span>上训练的，其中<span class="math inline">\(1\leq i_{b,1}&lt; i_{b,2}&lt;...&lt;i_{b,s_n}\leq n.\)</span>本文中假设子样本大小<span class="math inline">\(s_n\rightarrow \infty,s_n/n\rightarrow 0\)</span>当<span class="math inline">\(n\rightarrow \infty\)</span>时。数据重采样是无放回的。由<span class="math inline">\(\mathcal{D}_n^b\)</span>和随机抽取<span class="math inline">\(\xi_b\sim\Xi\)</span>构造的第<span class="math inline">\(b\)</span>棵树<span class="math inline">\(T_b\)</span>给出了<span class="math inline">\(m(x)\)</span>的估计：</p>
<p><span class="math display">\[
T_b(x;\mathcal{D}_n^b,\xi_b)=\frac{1}{N(L_b(x;\mathcal{D}_n^b,\xi_b))}\sum_{i:X_i\in L_b(x;\mathcal{D}_n^b,\xi_b)} Y_i,
\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="qrm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CBook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"toc_collapsed": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
